#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include "Whirlpool_7R_preimage_Fig3_BlueNB_4-4_0.h"

const unsigned char sbox[256] = {
	//0     1    2      3     4    5     6     7      8    9     A      B    C     D     E     F   
	0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76, //0  
	0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0, //1   
	0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15, //2   
	0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75, //3   
	0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84, //4   
	0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf, //5   
	0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8, //6   
	0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2, //7   
	0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73, //8   
	0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb, //9   
	0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79, //A   
	0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08, //B   
	0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a, //C   
	0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e, //D   
	0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf, //E   
	0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16 
	};

const unsigned char rsbox[256] = { 
	0x52, 0x09, 0x6a, 0xd5, 0x30, 0x36, 0xa5, 0x38, 0xbf, 0x40, 0xa3, 0x9e, 0x81, 0xf3, 0xd7, 0xfb,  
	0x7c, 0xe3, 0x39, 0x82, 0x9b, 0x2f, 0xff, 0x87, 0x34, 0x8e, 0x43, 0x44, 0xc4, 0xde, 0xe9, 0xcb,  
	0x54, 0x7b, 0x94, 0x32, 0xa6, 0xc2, 0x23, 0x3d, 0xee, 0x4c, 0x95, 0x0b, 0x42, 0xfa, 0xc3, 0x4e,  
	0x08, 0x2e, 0xa1, 0x66, 0x28, 0xd9, 0x24, 0xb2, 0x76, 0x5b, 0xa2, 0x49, 0x6d, 0x8b, 0xd1, 0x25,  
	0x72, 0xf8, 0xf6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xd4, 0xa4, 0x5c, 0xcc, 0x5d, 0x65, 0xb6, 0x92,  
	0x6c, 0x70, 0x48, 0x50, 0xfd, 0xed, 0xb9, 0xda, 0x5e, 0x15, 0x46, 0x57, 0xa7, 0x8d, 0x9d, 0x84,  
	0x90, 0xd8, 0xab, 0x00, 0x8c, 0xbc, 0xd3, 0x0a, 0xf7, 0xe4, 0x58, 0x05, 0xb8, 0xb3, 0x45, 0x06,  
	0xd0, 0x2c, 0x1e, 0x8f, 0xca, 0x3f, 0x0f, 0x02, 0xc1, 0xaf, 0xbd, 0x03, 0x01, 0x13, 0x8a, 0x6b,  
	0x3a, 0x91, 0x11, 0x41, 0x4f, 0x67, 0xdc, 0xea, 0x97, 0xf2, 0xcf, 0xce, 0xf0, 0xb4, 0xe6, 0x73,  
	0x96, 0xac, 0x74, 0x22, 0xe7, 0xad, 0x35, 0x85, 0xe2, 0xf9, 0x37, 0xe8, 0x1c, 0x75, 0xdf, 0x6e,  
	0x47, 0xf1, 0x1a, 0x71, 0x1d, 0x29, 0xc5, 0x89, 0x6f, 0xb7, 0x62, 0x0e, 0xaa, 0x18, 0xbe, 0x1b,  
	0xfc, 0x56, 0x3e, 0x4b, 0xc6, 0xd2, 0x79, 0x20, 0x9a, 0xdb, 0xc0, 0xfe, 0x78, 0xcd, 0x5a, 0xf4,  
	0x1f, 0xdd, 0xa8, 0x33, 0x88, 0x07, 0xc7, 0x31, 0xb1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xec, 0x5f,  
	0x60, 0x51, 0x7f, 0xa9, 0x19, 0xb5, 0x4a, 0x0d, 0x2d, 0xe5, 0x7a, 0x9f, 0x93, 0xc9, 0x9c, 0xef,  
	0xa0, 0xe0, 0x3b, 0x4d, 0xae, 0x2a, 0xf5, 0xb0, 0xc8, 0xeb, 0xbb, 0x3c, 0x83, 0x53, 0x99, 0x61,  
	0x17, 0x2b, 0x04, 0x7e, 0xba, 0x77, 0xd6, 0x26, 0xe1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0c, 0x7d 
	};

/*const unsigned char Rcon[255] = { 
	0x8d, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36, 0x6c, 0xd8, 0xab, 0x4d, 0x9a,    
	0x2f, 0x5e, 0xbc, 0x63, 0xc6, 0x97, 0x35, 0x6a, 0xd4, 0xb3, 0x7d, 0xfa, 0xef, 0xc5, 0x91, 0x39,    
	0x72, 0xe4, 0xd3, 0xbd, 0x61, 0xc2, 0x9f, 0x25, 0x4a, 0x94, 0x33, 0x66, 0xcc, 0x83, 0x1d, 0x3a,    
	0x74, 0xe8, 0xcb, 0x8d, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36, 0x6c, 0xd8,    
	0xab, 0x4d, 0x9a, 0x2f, 0x5e, 0xbc, 0x63, 0xc6, 0x97, 0x35, 0x6a, 0xd4, 0xb3, 0x7d, 0xfa, 0xef,    
	0xc5, 0x91, 0x39, 0x72, 0xe4, 0xd3, 0xbd, 0x61, 0xc2, 0x9f, 0x25, 0x4a, 0x94, 0x33, 0x66, 0xcc,    
	0x83, 0x1d, 0x3a, 0x74, 0xe8, 0xcb, 0x8d, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1b,    
	0x36, 0x6c, 0xd8, 0xab, 0x4d, 0x9a, 0x2f, 0x5e, 0xbc, 0x63, 0xc6, 0x97, 0x35, 0x6a, 0xd4, 0xb3,    
	0x7d, 0xfa, 0xef, 0xc5, 0x91, 0x39, 0x72, 0xe4, 0xd3, 0xbd, 0x61, 0xc2, 0x9f, 0x25, 0x4a, 0x94,    
	0x33, 0x66, 0xcc, 0x83, 0x1d, 0x3a, 0x74, 0xe8, 0xcb, 0x8d, 0x01, 0x02, 0x04, 0x08, 0x10, 0x20,    
	0x40, 0x80, 0x1b, 0x36, 0x6c, 0xd8, 0xab, 0x4d, 0x9a, 0x2f, 0x5e, 0xbc, 0x63, 0xc6, 0x97, 0x35,    
	0x6a, 0xd4, 0xb3, 0x7d, 0xfa, 0xef, 0xc5, 0x91, 0x39, 0x72, 0xe4, 0xd3, 0xbd, 0x61, 0xc2, 0x9f,    
	0x25, 0x4a, 0x94, 0x33, 0x66, 0xcc, 0x83, 0x1d, 0x3a, 0x74, 0xe8, 0xcb, 0x8d, 0x01, 0x02, 0x04,    
	0x08, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36, 0x6c, 0xd8, 0xab, 0x4d, 0x9a, 0x2f, 0x5e, 0xbc, 0x63,    
	0xc6, 0x97, 0x35, 0x6a, 0xd4, 0xb3, 0x7d, 0xfa, 0xef, 0xc5, 0x91, 0x39, 0x72, 0xe4, 0xd3, 0xbd,    
	0x61, 0xc2, 0x9f, 0x25, 0x4a, 0x94, 0x33, 0x66, 0xcc, 0x83, 0x1d, 0x3a, 0x74, 0xe8, 0xcb
	};*/

#define S(x) sbox[x]
#define R(x) rsbox[x]

unsigned char TableMul2_8[256][256];

void MakeTableMul2_8(void)
{
	int a,b;
	unsigned char aa,bb,r,t;
	for (a = 0; a <256 ; a++)
	{
		for (b = a; b < 256 ; b++)
		{
			aa=a;
			bb=b;
			r=0;
			while (aa != 0)
			{
				if ((aa & 1) != 0) r=r^bb;
				t=bb & 0x80;
				bb=bb<<1;
				if (t != 0) bb=bb^0x1b;
				aa=aa>>1;
			}
			TableMul2_8[a][b]=TableMul2_8[b][a]=r;
		}
	}
}

#define Multiply(a,b) TableMul2_8[a][b]

/*unsigned char Inverse(unsigned char a)
{
	static unsigned char TableInverse[256]={0x00,0x01,0x8d,0xf6,0xcb,0x52,0x7b,0xd1,0xe8,0x4f,0x29,0xc0,0xb0,0xe1,0xe5,0xc7,0x74,0xb4,0xaa,0x4b,0x99,0x2b,0x60,0x5f,0x58,0x3f,0xfd,0xcc,0xff,0x40,0xee,0xb2,0x3a,0x6e,0x5a,0xf1,0x55,0x4d,0xa8,0xc9,0xc1,0x0a,0x98,0x15,0x30,0x44,0xa2,0xc2,0x2c,0x45,0x92,0x6c,0xf3,0x39,0x66,0x42,0xf2,0x35,0x20,0x6f,0x77,0xbb,0x59,0x19,0x1d,0xfe,0x37,0x67,0x2d,0x31,0xf5,0x69,0xa7,0x64,0xab,0x13,0x54,0x25,0xe9,0x09,0xed,0x5c,0x05,0xca,0x4c,0x24,0x87,0xbf,0x18,0x3e,0x22,0xf0,0x51,0xec,0x61,0x17,0x16,0x5e,0xaf,0xd3,0x49,0xa6,0x36,0x43,0xf4,0x47,0x91,0xdf,0x33,0x93,0x21,0x3b,0x79,0xb7,0x97,0x85,0x10,0xb5,0xba,0x3c,0xb6,0x70,0xd0,0x06,0xa1,0xfa,0x81,0x82,0x83,0x7e,0x7f,0x80,0x96,0x73,0xbe,0x56,0x9b,0x9e,0x95,0xd9,0xf7,0x02,0xb9,0xa4,0xde,0x6a,0x32,0x6d,0xd8,0x8a,0x84,0x72,0x2a,0x14,0x9f,0x88,0xf9,0xdc,0x89,0x9a,0xfb,0x7c,0x2e,0xc3,0x8f,0xb8,0x65,0x48,0x26,0xc8,0x12,0x4a,0xce,0xe7,0xd2,0x62,0x0c,0xe0,0x1f,0xef,0x11,0x75,0x78,0x71,0xa5,0x8e,0x76,0x3d,0xbd,0xbc,0x86,0x57,0x0b,0x28,0x2f,0xa3,0xda,0xd4,0xe4,0x0f,0xa9,0x27,0x53,0x04,0x1b,0xfc,0xac,0xe6,0x7a,0x07,0xae,0x63,0xc5,0xdb,0xe2,0xea,0x94,0x8b,0xc4,0xd5,0x9d,0xf8,0x90,0x6b,0xb1,0x0d,0xd6,0xeb,0xc6,0x0e,0xcf,0xad,0x08,0x4e,0xd7,0xe3,0x5d,0x50,0x1e,0xb3,0x5b,0x23,0x38,0x34,0x68,0x46,0x03,0x8c,0xdd,0x9c,0x7d,0xa0,0xcd,0x1a,0x41,0x1c};
	return TableInverse[a];
}
*//* Index variables 
 * x[0] = 1
 * x[1] = SB_3[3,2]
 * x[2] = SB_3[2,1]
 * x[3] = SB_3[1,0]
 * x[4] = SB_3[0,3]
 * x[5] = AK_3[3,3]
 * x[6] = SB_3[3,1]
 * x[7] = SB_3[2,0]
 * x[8] = SB_3[1,3]
 * x[9] = SB_3[0,2]
 * x[10] = AK_3[3,2]
 * x[11] = SB_3[3,0]
 * x[12] = SB_3[2,3]
 * x[13] = SB_3[1,2]
 * x[14] = SB_3[0,1]
 * x[15] = AK_3[3,1]
 * x[16] = SB_3[3,3]
 * x[17] = SB_3[2,2]
 * x[18] = SB_3[1,1]
 * x[19] = SB_3[0,0]
 * x[20] = AK_3[3,0]
 * x[21] = AK_3[2,3]
 * x[22] = AK_3[2,2]
 * x[23] = AK_3[2,1]
 * x[24] = AK_3[2,0]
 * x[25] = AK_3[1,3]
 * x[26] = AK_3[1,2]
 * x[27] = AK_3[1,1]
 * x[28] = AK_3[1,0]
 * x[29] = AK_3[0,3]
 * x[30] = AK_3[0,2]
 * x[31] = AK_3[0,1]
 * x[32] = AK_3[0,0]
 * x[33] = AK_2[3,3]
 * x[34] = AK_2[3,2]
 * x[35] = AK_2[3,1]
 * x[36] = AK_2[3,0]
 * x[37] = AK_2[2,3]
 * x[38] = AK_2[2,2]
 * x[39] = AK_2[2,1]
 * x[40] = AK_2[2,0]
 * x[41] = AK_2[1,3]
 * x[42] = AK_2[1,2]
 * x[43] = AK_2[1,1]
 * x[44] = AK_2[1,0]
 * x[45] = AK_2[0,3]
 * x[46] = AK_2[0,2]
 * x[47] = AK_2[0,1]
 * x[48] = AK_2[0,0]
 * x[49] = MC_2[3,3]
 * x[50] = MC_2[3,2]
 * x[51] = MC_2[3,1]
 * x[52] = MC_2[3,0]
 * x[53] = MC_2[2,3]
 * x[54] = MC_2[2,2]
 * x[55] = MC_2[2,1]
 * x[56] = MC_2[2,0]
 * x[57] = MC_2[1,3]
 * x[58] = MC_2[1,2]
 * x[59] = MC_2[1,1]
 * x[60] = MC_2[1,0]
 * x[61] = MC_2[0,3]
 * x[62] = MC_2[0,2]
 * x[63] = MC_2[0,1]
 * x[64] = MC_2[0,0]
 **/
void Attack(const unsigned char Known[13])
{
	const unsigned char x0=Known[0]; /* 1 */
	const unsigned char x20=Known[1]; /* AK_3[3,0] */
	const unsigned char x22=Known[2]; /* AK_3[2,2] */
	const unsigned char x27=Known[3]; /* AK_3[1,1] */
	const unsigned char x32=Known[4]; /* AK_3[0,0] */
	const unsigned char x34=Known[5]; /* AK_2[3,2] */
	const unsigned char x39=Known[6]; /* AK_2[2,1] */
	const unsigned char x44=Known[7]; /* AK_2[1,0] */
	const unsigned char x45=Known[8]; /* AK_2[0,3] */
	const unsigned char x52=Known[9]; /* MC_2[3,0] */
	const unsigned char x55=Known[10]; /* MC_2[2,1] */
	const unsigned char x58=Known[11]; /* MC_2[1,2] */
	const unsigned char x61=Known[12]; /* MC_2[0,3] */
	const unsigned char x4=x45;
	const unsigned char x3=x44;
	const unsigned char x2=x39;
	const unsigned char x1=x34;
	
	Chaine8_3 espace_8[2];
	POSITION8_3 *L_8;
	L_8=malloc(taille1_8*sizeof(POSITION8_3));
	espace_8[1]=malloc(taille2_8*sizeof(CHAINE8_3));
	
	uint8_t Alloue_8=1;
	unsigned long int pos_8;
	for (pos_8 = 0; pos_8 < taille1_8 ; pos_8++) L_8[pos_8].a=0;
	unsigned long int cpt_8=0;
	int i_4;
	for (i_4 = 0; i_4 < 0x100; i_4++)
	{
		const unsigned char x7=i_4;
		int i_5;
		for (i_5 = 0; i_5 < 0x100; i_5++)
		{
			const unsigned char x8=i_5;
			int i_6;
			for (i_6 = 0; i_6 < 0x100; i_6++)
			{
				const unsigned char x11=i_6;
				int i_7;
				for (i_7 = 0; i_7 < 0x100; i_7++)
				{
					const unsigned char x12=i_7;
					pos_8=(S(x8) ^ Multiply(0x02,S(x7)));
					pos_8=(pos_8 << 8) ^ (Multiply(0x03,S(x12)) ^ S(x11));
					pos_8=(pos_8 << 8) ^ (Multiply(0x26,x12) ^ Multiply(0x9f,x8));
					pos_8=(pos_8 << 8) ^ (Multiply(0xec,x11) ^ Multiply(0x9a,x7));
					espace_8[1][cpt_8].d0=x7;
					espace_8[1][cpt_8].d1=x8;
					espace_8[1][cpt_8].d2=x11;
					espace_8[1][cpt_8].a=L_8[pos_8].a;
					espace_8[1][cpt_8].b=L_8[pos_8].b;
					L_8[pos_8].a=1;
					L_8[pos_8].b=cpt_8;
					cpt_8++;
				}
			}
		}
	}
	int i_0;
	for (i_0 = 0; i_0 < 0x100; i_0++)
	{
		const unsigned char x17=i_0;
		int i_1;
		for (i_1 = 0; i_1 < 0x100; i_1++)
		{
			const unsigned char x18=i_1;
			int i_2;
			for (i_2 = 0; i_2 < 0x100; i_2++)
			{
				const unsigned char x6=i_2;
				int i_3;
				for (i_3 = 0; i_3 < 0x100; i_3++)
				{
					const unsigned char x9=i_3;
					const unsigned char x13=Multiply(0xe5,x58) ^ Multiply(0x35,x34) ^ Multiply(0x5d,x17) ^ Multiply(0x8c,x9);
					const unsigned char x14=Multiply(0xe1,x55) ^ Multiply(0x39,x39) ^ Multiply(0xa8,x18) ^ Multiply(0x71,x6);
					const unsigned char x16=R(Multiply(0x68,x32) ^ Multiply(0xb9,x20) ^ S(x18) ^ Multiply(0xd1,S(x17)));
					const unsigned char x19=R(Multiply(0xd1,x32) ^ Multiply(0x68,x20) ^ Multiply(0xb9,S(x17)) ^ S(x16));
					pos_8=(x22 ^ S(x9) ^ Multiply(0x03,S(x6)));
					pos_8=(pos_8 << 8) ^ (x27 ^ S(x14) ^ Multiply(0x02,S(x13)));
					pos_8=(pos_8 << 8) ^ (Multiply(0x4f,x61) ^ Multiply(0xf7,x45) ^ x16);
					pos_8=(pos_8 << 8) ^ (Multiply(0xc0,x52) ^ Multiply(0xb7,x44) ^ x19);
					POSITION8_3 tmp2_8=L_8[pos_8];
					while (tmp2_8.a) /* Entrée : 4*/
					{
						const unsigned char x7=espace_8[1][tmp2_8.b].d0;
						const unsigned char x8=espace_8[1][tmp2_8.b].d1;
						const unsigned char x11=espace_8[1][tmp2_8.b].d2;
						tmp2_8.a=espace_8[1][tmp2_8.b].a;
						tmp2_8.b=espace_8[1][tmp2_8.b].b;
					/* --- 8 */
						const unsigned char x12=R(Multiply(0xf6,x27) ^ Multiply(0xf6,S(x14)) ^ Multiply(0xf7,S(x13)) ^ Multiply(0xf6,S(x11)));
						if ((Multiply(0x26,x12))==(Multiply(0x4f,x61) ^ Multiply(0xf7,x45) ^ x16 ^ Multiply(0x9f,x8)))
						{
							/* --- 8 */
							const unsigned char x5=Multiply(0x03,S(x4)) ^ S(x3) ^ S(x2) ^ Multiply(0x02,S(x1));
							const unsigned char x10=Multiply(0x03,x22) ^ Multiply(0x02,S(x8)) ^ Multiply(0x07,S(x7)) ^ Multiply(0x07,S(x6));
							const unsigned char x15=Multiply(0x03,x27) ^ Multiply(0x07,S(x13)) ^ Multiply(0x04,S(x12)) ^ S(x11);
							const unsigned char x21=S(x4) ^ S(x3) ^ Multiply(0x02,S(x2)) ^ Multiply(0x03,S(x1));
							const unsigned char x23=x27 ^ Multiply(0x03,S(x13)) ^ S(x12) ^ Multiply(0x02,S(x11));
							const unsigned char x24=Multiply(0xb9,x32) ^ Multiply(0xd1,x20) ^ Multiply(0x6a,S(x17)) ^ Multiply(0x03,S(x16));
							const unsigned char x25=S(x4) ^ Multiply(0x02,S(x3)) ^ Multiply(0x03,S(x2)) ^ S(x1);
							const unsigned char x26=x22 ^ Multiply(0x03,S(x8)) ^ S(x7) ^ Multiply(0x02,S(x6));
							const unsigned char x28=x32 ^ x20 ^ Multiply(0x03,S(x17)) ^ Multiply(0x02,S(x16));
							const unsigned char x29=Multiply(0x02,S(x4)) ^ Multiply(0x03,S(x3)) ^ S(x2) ^ S(x1);
							const unsigned char x30=Multiply(0x02,x22) ^ S(x8) ^ Multiply(0x05,S(x7)) ^ Multiply(0x07,S(x6));
							const unsigned char x31=Multiply(0x02,x27) ^ Multiply(0x07,S(x13)) ^ Multiply(0x07,S(x12)) ^ Multiply(0x03,S(x11));
							const unsigned char x33=Multiply(0x4f,x61) ^ Multiply(0xf7,x45) ^ Multiply(0x26,x12) ^ Multiply(0x9f,x8);
							const unsigned char x35=x6;
							const unsigned char x36=x11;
							const unsigned char x37=x12;
							const unsigned char x38=Multiply(0xc0,x58) ^ Multiply(0xb7,x34) ^ Multiply(0xec,x13) ^ Multiply(0x9a,x9);
							const unsigned char x40=x7;
							const unsigned char x41=x8;
							const unsigned char x42=x13;
							const unsigned char x43=Multiply(0x4f,x55) ^ Multiply(0xf7,x39) ^ Multiply(0x26,x14) ^ Multiply(0x9f,x6);
							const unsigned char x46=x9;
							const unsigned char x47=x14;
							const unsigned char x48=Multiply(0xc0,x52) ^ Multiply(0xb7,x44) ^ Multiply(0xec,x11) ^ Multiply(0x9a,x7);
							const unsigned char x49=Multiply(0xf7,x61) ^ Multiply(0xf6,x45) ^ Multiply(0xf6,x12) ^ Multiply(0xf6,x8);
							const unsigned char x50=Multiply(0x9a,x58) ^ Multiply(0x76,x34) ^ Multiply(0xc0,x13) ^ Multiply(0x2d,x9);
							const unsigned char x51=Multiply(0x26,x55) ^ Multiply(0xf6,x39) ^ Multiply(0x9e,x14) ^ Multiply(0x4f,x6);
							const unsigned char x53=Multiply(0x9f,x61) ^ Multiply(0xf6,x45) ^ Multiply(0x4f,x12) ^ Multiply(0x27,x8);
							const unsigned char x54=Multiply(0xec,x58) ^ Multiply(0x5b,x34) ^ Multiply(0x76,x13) ^ Multiply(0xc0,x9);
							const unsigned char x56=Multiply(0xb7,x52) ^ Multiply(0x9b,x44) ^ Multiply(0x5b,x11) ^ Multiply(0x76,x7);
							const unsigned char x57=Multiply(0x26,x61) ^ Multiply(0xf6,x45) ^ Multiply(0x9e,x12) ^ Multiply(0x4f,x8);
							const unsigned char x59=Multiply(0xf7,x55) ^ Multiply(0xf6,x39) ^ Multiply(0xf6,x14) ^ Multiply(0xf6,x6);
							const unsigned char x60=Multiply(0x9a,x52) ^ Multiply(0x76,x44) ^ Multiply(0xc0,x11) ^ Multiply(0x2d,x7);
							const unsigned char x62=Multiply(0xb7,x58) ^ Multiply(0x9b,x34) ^ Multiply(0x5b,x13) ^ Multiply(0x76,x9);
							const unsigned char x63=Multiply(0x9f,x55) ^ Multiply(0xf6,x39) ^ Multiply(0x4f,x14) ^ Multiply(0x27,x6);
							const unsigned char x64=Multiply(0xec,x52) ^ Multiply(0x5b,x44) ^ Multiply(0x76,x11) ^ Multiply(0xc0,x7);
							printf("# Solution found :\n");
							printf("SB_3[3,2] = %02x\n",x1);
							printf("SB_3[2,1] = %02x\n",x2);
							printf("SB_3[1,0] = %02x\n",x3);
							printf("SB_3[0,3] = %02x\n",x4);
							printf("AK_3[3,3] = %02x\n",x5);
							printf("SB_3[3,1] = %02x\n",x6);
							printf("SB_3[2,0] = %02x\n",x7);
							printf("SB_3[1,3] = %02x\n",x8);
							printf("SB_3[0,2] = %02x\n",x9);
							printf("AK_3[3,2] = %02x\n",x10);
							printf("SB_3[3,0] = %02x\n",x11);
							printf("SB_3[2,3] = %02x\n",x12);
							printf("SB_3[1,2] = %02x\n",x13);
							printf("SB_3[0,1] = %02x\n",x14);
							printf("AK_3[3,1] = %02x\n",x15);
							printf("SB_3[3,3] = %02x\n",x16);
							printf("SB_3[2,2] = %02x\n",x17);
							printf("SB_3[1,1] = %02x\n",x18);
							printf("SB_3[0,0] = %02x\n",x19);
							printf("AK_3[3,0] = %02x\n",x20);
							printf("AK_3[2,3] = %02x\n",x21);
							printf("AK_3[2,2] = %02x\n",x22);
							printf("AK_3[2,1] = %02x\n",x23);
							printf("AK_3[2,0] = %02x\n",x24);
							printf("AK_3[1,3] = %02x\n",x25);
							printf("AK_3[1,2] = %02x\n",x26);
							printf("AK_3[1,1] = %02x\n",x27);
							printf("AK_3[1,0] = %02x\n",x28);
							printf("AK_3[0,3] = %02x\n",x29);
							printf("AK_3[0,2] = %02x\n",x30);
							printf("AK_3[0,1] = %02x\n",x31);
							printf("AK_3[0,0] = %02x\n",x32);
							printf("AK_2[3,3] = %02x\n",x33);
							printf("AK_2[3,2] = %02x\n",x34);
							printf("AK_2[3,1] = %02x\n",x35);
							printf("AK_2[3,0] = %02x\n",x36);
							printf("AK_2[2,3] = %02x\n",x37);
							printf("AK_2[2,2] = %02x\n",x38);
							printf("AK_2[2,1] = %02x\n",x39);
							printf("AK_2[2,0] = %02x\n",x40);
							printf("AK_2[1,3] = %02x\n",x41);
							printf("AK_2[1,2] = %02x\n",x42);
							printf("AK_2[1,1] = %02x\n",x43);
							printf("AK_2[1,0] = %02x\n",x44);
							printf("AK_2[0,3] = %02x\n",x45);
							printf("AK_2[0,2] = %02x\n",x46);
							printf("AK_2[0,1] = %02x\n",x47);
							printf("AK_2[0,0] = %02x\n",x48);
							printf("MC_2[3,3] = %02x\n",x49);
							printf("MC_2[3,2] = %02x\n",x50);
							printf("MC_2[3,1] = %02x\n",x51);
							printf("MC_2[3,0] = %02x\n",x52);
							printf("MC_2[2,3] = %02x\n",x53);
							printf("MC_2[2,2] = %02x\n",x54);
							printf("MC_2[2,1] = %02x\n",x55);
							printf("MC_2[2,0] = %02x\n",x56);
							printf("MC_2[1,3] = %02x\n",x57);
							printf("MC_2[1,2] = %02x\n",x58);
							printf("MC_2[1,1] = %02x\n",x59);
							printf("MC_2[1,0] = %02x\n",x60);
							printf("MC_2[0,3] = %02x\n",x61);
							printf("MC_2[0,2] = %02x\n",x62);
							printf("MC_2[0,1] = %02x\n",x63);
							printf("MC_2[0,0] = %02x\n",x64);
							return ;/*getchar();*/
						}
					}
				}
			}
		}
	}
	int j_8;
	for (j_8 = 1; j_8 <= Alloue_8; j_8++) free(espace_8[j_8]);
	free(L_8);
}

int Generator(unsigned char Known[13]/*, unsigned char y[65]*/)
{
	const unsigned char x0=1;
	const unsigned char x61=1+(rand()%255);
	const unsigned char x20=1+(rand()%255);
	const unsigned char x22=1+(rand()%255);
	const unsigned char x27=1+(rand()%255);
	const unsigned char x32=1+(rand()%255);
	const unsigned char x34=1+(rand()%255);
	const unsigned char x39=1+(rand()%255);
	const unsigned char x44=1+(rand()%255);
	const unsigned char x45=1+(rand()%255);
	const unsigned char x52=1+(rand()%255);
	const unsigned char x55=1+(rand()%255);
	const unsigned char x58=1+(rand()%255);
	Known[0]=x0; /* 1 */
	Known[1]=x20; /* AK_3[3,0] */
	Known[2]=x22; /* AK_3[2,2] */
	Known[3]=x27; /* AK_3[1,1] */
	Known[4]=x32; /* AK_3[0,0] */
	Known[5]=x34; /* AK_2[3,2] */
	Known[6]=x39; /* AK_2[2,1] */
	Known[7]=x44; /* AK_2[1,0] */
	Known[8]=x45; /* AK_2[0,3] */
	Known[9]=x52; /* MC_2[3,0] */
	Known[10]=x55; /* MC_2[2,1] */
	Known[11]=x58; /* MC_2[1,2] */
	Known[12]=x61; /* MC_2[0,3] */
	return 1;
	return 0;
}

int main(int argc, char** argv)
{
	unsigned char Known[13];
   srand(getpid()); /* Init PRNG */
	MakeTableMul2_8();
	/* assign values */
	Generator(Known);
	/* Attack */
	Attack(Known);
	return 0;
}
